# hotelManagementSystem
酒店管理系统

# hotel-client  网页pc端版

- login 登录界面
  1. css3 skew 倾斜属性
    绘制页面倾斜拼接
  2. 验证码验证  注意：在登录与注册切换时，要刷新验证码图片，采用的方式是父组件调用子组件的方法
    - 使用 canvas 绘制验证码
    - 使用 watch 来监听验证码的绘制的结果
    - 准备工作：生成一个随机整数 => 生成一个随机颜色( rgb 颜色)
    - 绘制图片
      1. 拿到画布 getContext
      2. 绘制背景 ctx.fillStyle 随机色
      3. 填充位置 ctx.fillRect
      4. 绘制内容
        - 随机生成长度为4的字符串 
          1. 随机生成单个字符
          2. 随机字体大小
          3. 字体随机旋转角度
          4. 字体样式
          5. 填充位置
          6. 利用 ctx.save() 保存当前状态
          7. 将文字旋转处理好后，绘制到画布上 ctx.fillText 
          8. 利用 ctx.restore() 还原之前保存的状态
        - 随机生成5条干扰线条
          1. ctx.beginPath 起始一条路径
          2. ctx.moveTo 把路径移动到画布中的指定点，不创建线条
          3. ctx.lineTo 添加一个新点，然后在画布中创建从该点到最后指定点的线条
          4. ctx.strokeStyle 绘制已定义的路径
          5. ctx.closePath() 创建从当前点回到起始点的路径
          6. ctx.stroke() 绘制已定义路径
        - 随机产生40个干扰的小点
          1. ctx.arc() 创建曲线
          2. ctx.fill() 填充当前绘图
  3. 忘记密码
    - 对密码进行修改
    - 修改完毕后转到登录状态进行登录才可进入首页
  4. 记住我
    - 先利用 crypto 插件对密码进行加密操作
    - 再将工号和密码存储到本地存储中
  5. 在页面过载时，若本地存储了记住我的信息，先将密码进行解密操作，再将其自动填入到页面信息中

- home 页面 采用 element UI 框架布局
  1. 头部 el-header 
    - 收缩菜单栏的图标
      1. 点击事件改变菜单栏的状态：展开 收起
      2. 本操作涉及到子组件与子组件之间的通信，采取的是使用总线机制 bus 在非父子组件之间通信 (header.vue 与 aside.vue 界面通信 ————————— 菜单栏的状态)
      3. 在 header 界面将菜单栏的状态进行改变，保存状态到本地存储中，并采取 bus.$emit 对 aside 界面通信
      4. 在 aside 界面挂载时，从本地存储中取出菜单栏的状态，然后采用 bus.$on 接收信息，从而对菜单栏的宽度进行改变，内容进行收缩
    - 侧边栏 el-aside —————————— 菜单栏
      1. 挂载时从本地存储中提取权限，然后按照权限展现菜单栏内容
    - 用户姓名
      实现父组件向子组件的通信，即将父组件中获取的用户信息传入子组件中
    - 下拉菜单 el-dropdown
      1. 锁定系统
        点击锁定，将当前要跳转的页面路径作为参数传到锁定页面 lock/index.vue，并将锁定状态存入本地存储中
      2. 退出系统
    - 头像

- lock 界面
  1. 设计弹出层 van-popup
  2. 与服务端进行密码匹配
    - 匹配成功，跳转到锁定前的页面或 home 界面
    - 匹配失败，则提示密码错误
  3. 匹配成功时，改变本地存储的锁定状态



# hotel-cleaner 清洁工系统 移动端版

- login 页面
  与 hotel-client 界面与功能相似，但其为响应式的，适配各种手机型号

- home 界面




# hotel-server 服务端
  - 使用 koa 技术 + MongoDB 数据库
  - 使用 koa2-cors 解决跨域问题
  - 利用 koa-bodyparser 帮助 koa 做参数解析

1. 用户控制层 user_controller
  - 检验用户登录
    1. 连接数据库，去数据库中查找是否存在前端传过来的信息，获取到用户的userId
    2. 若不存在，则返回
    3. 若存在，则查询密码
      - 如果在密码表中找到了账号相同的id，则判断该id对应的密码和前端传过来的密码是否匹配
      - 密码表中的密码需解密
      - 将比较结果返回给前端
  - 修改密码
    - 与用户登录信息匹配一二点相似
    - 若存在时，则先将前端传过来的密码加密，然后将加密后的密码修改密码表中查询到的指定信息中的密码
    - 修改完毕，将结果返回给前端



注意： 
  1. 登录拦截 实现用户登录后才可访问该页面
    - 在路由器 router 下的 index.js 的配置中，给需要拦截登录的页面的路由添加一个 meta: { loginRequest: true }，loginRequest 自定义遍历
    - 在 main.js 中添加 路由的 beforeEach 钩子函数 (三个参数 to from next)
      1. 判断即将进入的目标路由 meta 中 loginRequest，为 true 则将其进行拦截，否则则直接进入页面
      2. 拦截后，判断本地存储是否存入登录的信息，若存储了，则直接进入页面，否则则跳转到登录页面，并记住要跳入的页面，以方便登录后直接进入该页面